#!/usr/bin/env ruby

require 'haml-i18n-extractor'

@prompter = Haml::I18n::Extractor::Prompter.new

option_parser = Trollop::Parser.new do
  banner <<-EOB

  haml-i18n-extractor <path> [--interactive|--non-interactive] [--other-options]

  See options list:
EOB
  version "Current version: #{Haml::I18n::Extractor::VERSION}"
  opt :interactive, "interactive mode", :short => 'i'
  opt :non_interactive, "non interactive mode", :short => 'n'
  opt :yaml_file, "yaml file, defaults to en", :type => String, :short => 'y'
end

opts = Trollop::with_standard_exception_handling option_parser do
  raise Trollop::HelpNeeded if ARGV.empty?
  option_parser.parse ARGV
end

path_to_extract = File.expand_path(ARGV[0])
if File.exist?(path_to_extract)
  opts[:path] = path_to_extract
end

begin
  Haml::I18n::Extractor::CLI.new(opts).start
rescue  Haml::I18n::Extractor::CLI::CliError
  @prompter.puts("please try again")
end
